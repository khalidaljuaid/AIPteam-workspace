// AIPioneers Workspace - Database Schema
// 7 أقسام رئيسية

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========== 1. إدارة المحتوى والمنشورات ==========

model ContentPost {
  id                String      @id @default(uuid())
  publishDate       DateTime    // تاريخ النشر
  contentType       String      // نوع المحتوى: مصادر علمية، عن الفريق، أنشطة وفعاليات، تعليمي، مناسبات
  writer            String      // الكاتب
  captionLinkedIn   String      // Caption LinkedIn
  captionX          String      // Caption X
  captionInstagram  String      // Caption Instagram/TikTok
  designLink        String      // رابط التصميم
  contentAfterReview String     // المحتوى بعد المراجعة
  reviewer          String      // مسؤول المراجعة
  status            String      // الحالة: تم النشر، تحت المراجعة، غير مجدي
  
  // تشيك ليست
  publishedLinkedIn Boolean     @default(false)
  publishedX        Boolean     @default(false)
  publishedInstagram Boolean    @default(false)
  publishedTikTok   Boolean     @default(false)
  
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  
  @@index([publishDate])
  @@index([status])
}

// ========== 2. إدارة المتابعة والتطوير ==========

// ورقة 1: متابعة الإدارات
model DepartmentTask {
  id                String      @id @default(uuid())
  followerMember    String      // العضو المتابع
  task              String      // المهمة
  responsibleDept   String      // الإدارة المسؤولة
  responsibleMember String      // العضو المسؤول
  assignDate        DateTime    // تاريخ تعيين المهمة
  deadline          DateTime    // تاريخ الموعد النهائي
  status            String      // الحالة: لم تبدأ، قيد التنفيذ، مكتمل
  notes             String?     // ملاحظات
  
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  
  @@index([deadline])
  @@index([status])
}

// ورقة 2: متابعة الفعاليات
model EventTracking {
  id                String      @id @default(uuid())
  followerMember    String      // العضو المتابع
  eventName         String      // اسم الفعالية
  eventDate         DateTime    // تاريخ الفعالية
  stage             String      // المرحلة: تصاميم، تسويق ونشر، بحث عن رعاة، تجهيز محتوى مدرب، نشر مشروع
  responsibleDept   String      // الإدارة المسؤولة
  stageDeadline     DateTime    // الموعد النهائي للمرحلة
  status            String      // الحالة
  
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  
  @@index([eventDate])
  @@index([status])
}

// ورقة 3: تطبيق الانضباط
model DisciplineRecord {
  id                String      @id @default(uuid())
  followerMember    String      // العضو المتابع
  violatorName      String      // اسم العضو المخالف
  violationDate     DateTime    // تاريخ المخالفة
  responsibleDept   String      // الإدارة المسؤولة
  violation         String      // المخالفة
  actionTaken       String      // الاجراء المتخذ
  status            String      // الحالة
  notes             String?     // ملاحظات
  
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  
  @@index([violationDate])
}

// ========== 3. إدارة العلاقات العامة ==========

model Sponsor {
  id                String   @id @default(uuid())
  sponsorName       String   // اسم الراعي
  sponsorshipType   String   // نوع الرعاية
  service           String   // الخدمة
  relatedEvent      String   // اسم الفعالية المرتبطة
  sponsorAccounts   String   // حسابات الراعي
  requirements      String   // متطلبات الراعي
  responsibleMember String   // اسم العضو المسؤول
  
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

// ========== 4. إدارة الإبداع ==========

model CreativeTask {
  id                String           @id @default(uuid())
  memberName        String           // اسم العضو
  task              String           // المهمة
  textualContent    String?          // المحتوى النصي
  driveLink         String?          // رابط الملف في الدرايف
  canvaLink         String?          // رابط كانفا
  deliveryDate      DateTime         // تاريخ التسليم
  priority          String           // مستوى الأهمية: قادم، عاجل، متوسط
  status            String           // الحالة: تم التسليم، قيد التنفيذ، لم تبدأ
  decision          String           // القرار: معتمد، مرفوض، قيد المراجعة
  
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  
  @@index([deliveryDate])
  @@index([status])
}

// ========== 5. إدارة المحتوى التعليمي ==========

model EducationalContent {
  id              String          @id @default(uuid())
  courseName      String          // الكورس
  memberName      String          // اسم العضو
  source          String          // المصدر
  task            String          // المهمة
  details         String          // التفاصيل
  deadline        DateTime        // Deadline
  taskLink        String?         // رابط المهمة Canva
  status          String          // الحالة
  reviewStatus    String          // المراجعة والتدقيق: تمت المراجعة، قيد التنفيذ، لم تبدأ
  
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  
  @@index([deadline])
  @@index([status])
}

// ========== 6. إدارة الأنشطة والفعاليات ==========

model Activity {
  id              String         @id @default(uuid())
  activityName    String         // اسم النشاط/الفعالية
  activityType    String         // نوع النشاط
  description     String         // الوصف
  startDate       DateTime       // تاريخ البداية
  endDate         DateTime?      // تاريخ النهاية
  location        String?        // الموقع
  responsibleTeam String         // الفريق المسؤول
  budget          Float?         // الميزانية
  attendees       Int?           // عدد الحضور
  status          String         // الحالة
  notes           String?        // ملاحظات
  
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  
  @@index([startDate])
  @@index([status])
}

// ========== 7. إدارة المشاريع ==========

model Project {
  id              String         @id @default(uuid())
  projectName     String         // اسم المشروع
  projectType     String         // نوع المشروع
  description     String         // الوصف
  startDate       DateTime       // تاريخ البداية
  expectedEnd     DateTime       // التاريخ المتوقع للانتهاء
  actualEnd       DateTime?      // التاريخ الفعلي للانتهاء
  budget          Float?         // الميزانية
  teamMembers     String         // قائمة الأعضاء
  milestones      String         // المراحل الرئيسية
  status          String         // الحالة: التخطيط، قيد التنفيذ، متوقف مؤقتاً، مكتمل، ملغي
  progress        Int            @default(0) // نسبة الإنجاز %
  
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  
  @@index([startDate])
  @@index([status])
}

// ========== 8. مساحة التعاون المشتركة ==========

model Collaboration {
  id                String      @id @default(uuid())
  title             String      // العنوان
  description       String      // الوصف
  departments       String      // الأقسام المشاركة
  members           String      // الأعضاء المشاركين
  startDate         DateTime    // تاريخ البداية
  deadline          DateTime?   // الموعد النهائي
  status            String      // الحالة
  sharedResources   String?     // الموارد المشتركة
  notes             String?     // ملاحظات
  
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  
  @@index([deadline])
  @@index([status])
}

// ========== Users for Authentication ==========

model User {
  id            String      @id @default(uuid())
  email         String      @unique
  passwordHash  String
  name          String?
  firstName     String?
  lastName      String?
  avatarUrl     String?
  department    String?     // الإدارة
  role          String      @default("MEMBER") // الدور: ADMIN, LEADER, MEMBER
  
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  
  @@index([email])
}
